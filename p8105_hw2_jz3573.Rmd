---
title: "p8105_hw2_jz3573"
output:
 github_document: 
date: "2023-10-03"
---


## Load library 
```{r setup}
library(tidyverse)
library(tidyr)
library(dplyr)
```


# Quesioin 2

## tidy up Mr.Trash Wheel
```{r tidy up Mr.Trash Wheel}
Mr=
  read_excel("./data/Trash.xlsx", 1,range="A2:N586") %>% 
  janitor::clean_names() %>% 
  rename(dumpster_number=dumpster) %>% 
  drop_na(dumpster_number) %>% 
  mutate(homes_powered = weight_tons *500/30,
         trash_wheel="Mr")
 
skimr::skim(Mr)
```
## Tidy up Professor Trash Wheel
```{r tidy up Professor Trash Wheel}
Pro=
  read_excel("./data/Trash.xlsx", 2,range="A2:M108") %>% 
  janitor::clean_names() %>% 
  rename(dumpster_number=dumpster) %>% 
  drop_na(dumpster_number) %>% 
  mutate(homes_powered = weight_tons *500/30,
         trash_wheel="Professor")
```

## Tidy up Gwynnda
```{r tidy up Gwynnda Trash Wheel}
Gwy=
  read_excel("./data/Trash.xlsx", 3 ,range="A2:L157") %>% 
  janitor::clean_names() %>% 
  rename(dumpster_number=dumpster) %>% 
  drop_na(dumpster_number) %>% 
  mutate(homes_powered= weight_tons *500/30,
          trash_wheel="Gwynnda") 
  

 skimr::skim(Gwy)

```
## Join the three datasets
```{r join datasets}
joint=
     full_join(Gwy, Pro) |>
     full_join(x = _, y = Mr)
 
  
```

## Descriptiion of the dataset:
 
The dataset contains `r nrow(joint)` observations and `r ncol(joint)` variables.

The total weight of trash collected by Professor Trash Wheel is `r subset(joint, trash_wheel == "Professor") |> pull(weight_tons) |> sum()`

The dataset describe the detail of drumpsters, which include the drumpsters' number, the weight of trash and the type of trash. 

The total number of cigarette butts collected by Gwynnda in July of 2021 is `r subset(joint, trash_wheel=="Gwynnda" &  month=="July" & year=="2021") %>% pull (cigarette_butts) %>% sum()`



# Question 3

## Tidy baseline df
```{r tidy baseline df }
baseline=
  read.csv("./data/data_mci/MCI_baseline.csv", skip = 1) %>% 
  janitor::clean_names() %>% 
  mutate(
      sex =case_match(sex,
                      0 ~ "female",
                      1 ~ "male"),
      apoe4=case_match(apoe4,
                      1 ~ "carrier",
                      0 ~ "non-carrier")) %>% 
     filter( age_at_onset=="." | age_at_onset>  current_age)

```

Above codes ensure that sex and APOE4 carrier status are appropriate encoded and every participant meet the stated inclusion criteria (i.e. no MCI at baseline).

## Description of the baseline df

How many participants were recruited: `r nrow(baseline)`
How many participants develop MCI?  `r filter(baseline, age_at_onset! = "." %>% nrow ())`
What is the average baseline age?  `r pull(baseline, current_age) %>%  mean()`
What proportion of women in the study are APOE4 carriers? 
`r scales::percent(nrow(filter(baseline, sex == "female" & apoe4 =="carrier")) / nrow(filter(baseline, sex == "female")))`

## Tidy up the longitudinal data:
```{r amyloid}
amyloid=
  read.csv("./data/data_mci/mci_amyloid.csv", skip = 1) %>% 
  janitor::clean_names() %>% 
  pivot_longer(
    cols=baseline:time_8, 
    names_to = "time", 
    values_to = "amyloid_ratio")
```

